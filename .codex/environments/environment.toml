# THIS IS AUTOGENERATED. DO NOT EDIT MANUALLY
version = 1
name = "party-starter"

[setup]
script = '''
#!/usr/bin/env bash

############################################
# Configuration
# Add or remove files that should be copied
# from the main worktree into this worktree
############################################
FILES_TO_COPY=(
  ".env"
  ".env.local"
  ".env.development.local"
)

############################################
# Strict mode
# -e  → Exit immediately if any command fails
# -u  → Treat unset variables as errors
# -o pipefail → Fail if any command in a pipeline fails
############################################
set -euo pipefail


# Resolve the shared Git directory (used by all worktrees)
COMMON_GIT_DIR="$(cd "$(git rev-parse --git-common-dir)" && pwd -P)"

# The main worktree is the parent directory of the common Git dir
MAIN_WORKTREE="$(cd "${COMMON_GIT_DIR}/.." && pwd -P)"

echo "[setup] Main worktree: $MAIN_WORKTREE"
echo "[setup] Current worktree: $(pwd -P)"

for f in "${FILES_TO_COPY[@]}"; do
  src="$MAIN_WORKTREE/$f"
  dst="./$f"

  # Skip if file already exists in the current worktree
  if [[ -f "$dst" ]]; then
    echo "[setup] $f already exists in worktree, skipping."
    continue
  fi

  # Copy only if file exists in the main worktree
  if [[ -f "$src" ]]; then
    echo "[setup] Copying $f"
    mkdir -p "$(dirname "$dst")"
    cp "$src" "$dst"
  else
    echo "[setup] $f not found in main worktree, skipping."
  fi
done

echo "[setup] Installing dependencies with pnpm..."
pnpm install

echo "[setup] Setup complete."

'''
